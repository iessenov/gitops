# Traefik Helm Chart Values

# Deployment configuration
deployment:
  kind: DaemonSet
  enabled: true
  
# Ports configuration
ports:
  web:
    # HTTP port - using 801 to avoid collision with ingress-nginx
    port: 8000
    exposedPort: 801
    hostPort: 801
    expose:
      default: true
    protocol: TCP
  websecure:
    # HTTPS port
    port: 8443
    exposedPort: 4431
    hostPort: 4431
    expose:
      default: true
    protocol: TCP
    # Enable TLS by default
    tls:
      enabled: true
  metrics:
    # Prometheus metrics
    port: 9100
    expose:
      default: false
    protocol: TCP

# Enable dashboard (optional - disable in production)
ingressRoute:
  dashboard:
    enabled: true
    # Uncomment to expose dashboard via ingress
    # matchRule: Host(`traefik.yourdomain.com`)
    # entryPoints: ["websecure"]

# Service configuration - disabled when using hostPort with DaemonSet
service:
  enabled: false

# Logs
logs:
  general:
    level: INFO
  access:
    enabled: true

# Enable Prometheus metrics
metrics:
  prometheus:
    enabled: true
    addEntryPointsLabels: true
    addServicesLabels: true

# Providers
providers:
  kubernetesCRD:
    enabled: true
    allowCrossNamespace: true
  kubernetesIngress:
    enabled: true
    allowExternalNameServices: true
    publishedService:
      enabled: true

# Additional arguments
additionalArguments:
  # Enable access logs
  - "--accesslog=true"
  # Enable API and dashboard
  - "--api.dashboard=true"

# Resources (adjust as needed)
resources:
  requests:
    cpu: "100m"
    memory: "50Mi"
  limits:
    cpu: "300m"
    memory: "150Mi"

# Security context
securityContext:
  capabilities:
    drop: [ALL]
  readOnlyRootFilesystem: true
  runAsGroup: 65532
  runAsNonRoot: true
  runAsUser: 65532

podSecurityContext:
  fsGroup: 65532

# Tolerations to run on control-plane nodes (same as ingress-nginx)
tolerations:
  - key: "node-role.kubernetes.io/control-plane"
    operator: "Exists"
    effect: "NoSchedule"
  - key: "node-role.kubernetes.io/master"
    operator: "Exists"
    effect: "NoSchedule"
